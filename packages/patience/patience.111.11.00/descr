Patience diff algorithm, in pure OCaml

Extracted from core_kernel